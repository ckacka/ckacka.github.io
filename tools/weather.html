<!DOCTYPE html>  
<html lang="zh-CN">  
<head>  
    <meta charset="UTF-8">  
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">  
    <title>树洞天气助手</title>  
    <link rel="stylesheet" href="https://res.wx.qq.com/open/libs/weui/2.3.0/weui.min.css"/>  
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">  
    <style>  
    /* --- 优化后的配色方案 --- */  
    :root {  
        --primary-blue: #2c80ff;  
        --primary-blue-light: #5a9dff;  
        --primary-blue-dark: #1a5fcc;  
        --neutral-light: #f8f9fa;  
        --neutral-dark: #2a2d32;  
        --text-primary: #1a1a1a;  
        --text-secondary: #666;  
        --text-tertiary: #999;  
        --border-color: rgba(0,0,0,0.08);  
    }  

    [data-weui-theme='dark'] {  
        --primary-blue: #5a9dff;  
        --primary-blue-light: #7ab2ff;  
        --primary-blue-dark: #4a8aff;  
        --neutral-light: #1e1f23;  
        --neutral-dark: #121317;  
        --text-primary: #f0f0f0;  
        --text-secondary: #bbb;  
        --text-tertiary: #888;  
        --border-color: rgba(255,255,255,0.1);  
    }  

    body {  
        background-color: var(--neutral-light);  
        color: var(--text-primary);  
        font-family: -apple-system-font, Helvetica Neue, Helvetica, sans-serif;  
        touch-action: manipulation;  
        transition: background-color 0.3s ease, color 0.3s ease;  
    }  

    /* 顶部天气概览卡片 - 简化设计，无边框 */  
    .weather-hero {  
        background: linear-gradient(135deg, var(--primary-blue) 0%, var(--primary-blue-light) 100%);  
        color: white;  
        padding: 30px 20px;  
        text-align: center;  
        position: relative;  
        margin-bottom: 0;  
    }  

    [data-weui-theme='dark'] .weather-hero {  
        background: linear-gradient(135deg, var(--primary-blue-dark) 0%, var(--primary-blue) 100%);  
    }  

    .hero-city {  
        font-size: 24px;  
        font-weight: 500;  
        margin-bottom: 5px;  
        text-shadow: 0 1px 2px rgba(0,0,0,0.1);  
    }  

    .hero-date {  
        font-size: 13px;  
        opacity: 0.9;  
        margin-bottom: 20px;  
    }  

    .hero-main {  
        display: flex;  
        justify-content: center;  
        align-items: center;  
        gap: 20px;  
        margin-bottom: 20px;  
    }  

    .hero-temp {  
        font-size: 64px;  
        font-weight: 300;  
        line-height: 1;  
        text-shadow: 0 2px 4px rgba(0,0,0,0.1);  
    }  

    .hero-icon {  
        font-size: 48px;  
        opacity: 0.9;  
    }  

    .hero-status {  
        font-size: 18px;  
        font-weight: 500;  
        margin-bottom: 5px;  
    }  

    .hero-range {  
        font-size: 14px;  
        opacity: 0.9;  
    }  

    .hero-notice {  
        font-size: 12px;  
        margin-top: 15px;  
        opacity: 0.8;  
        line-height: 1.4;  
    }  

    /* 更新时间角标 */  
    .update-badge {  
        position: absolute;  
        top: 10px;  
        right: 10px;  
        font-size: 10px;  
        background: rgba(255,255,255,0.2);  
        padding: 3px 8px;  
        border-radius: 12px;  
        backdrop-filter: blur(4px);  
    }  

    /* 详情网格样式 - 去掉边框，用更柔和的背景色 */  
    .weui-grids {  
        background: transparent;  
        margin-top: 0;  
    }  

    .weui-grid {  
        padding: 20px 10px;  
        background-color: transparent;  
        position: relative;  
    }  

    /* 网格项之间的分隔线 */  
    .weui-grid:not(:nth-child(3n))::after {  
        content: '';  
        position: absolute;  
        right: 0;  
        top: 25%;  
        height: 50%;  
        width: 1px;  
        background-color: var(--border-color);  
    }  

    .weui-grid:nth-child(n+4)::before {  
        content: '';  
        position: absolute;  
        left: 15px;  
        right: 15px;  
        top: 0;  
        height: 1px;  
        background-color: var(--border-color);  
    }  

    .weui-grid__icon {  
        color: var(--primary-blue);  
        font-size: 20px;  
        width: 24px;  
        height: 24px;  
        margin-bottom: 8px;  
    }  

    .weui-grid__label {  
        font-size: 12px;  
        color: var(--text-secondary);  
        margin-top: 0;  
    }  

    .grid-value {  
        font-size: 16px;  
        font-weight: 600;  
        color: var(--text-primary);  
        display: block;  
        margin-top: 4px;  
    }  

    /* 横向滚动预报 - 去掉边框，用阴影和背景色区分 */  
    .forecast-scroll-container {  
        display: flex;  
        overflow-x: auto;  
        padding: 15px;  
        gap: 12px;  
        -webkit-overflow-scrolling: touch;  
        background: transparent;  
    }  

    .forecast-scroll-container::-webkit-scrollbar {  
        display: none;  
    }  

    .forecast-item {  
        flex: 0 0 80px;  
        display: flex;  
        flex-direction: column;  
        align-items: center;  
        justify-content: center;  
        background: var(--neutral-light);  
        padding: 15px 5px;  
        border-radius: 12px;  
        text-align: center;  
        font-size: 12px;  
        box-shadow: 0 2px 8px rgba(0,0,0,0.05);  
        transition: all 0.2s ease;  
    }  

    [data-weui-theme='dark'] .forecast-item {  
        box-shadow: 0 2px 8px rgba(0,0,0,0.2);  
    }  

    .forecast-item:hover {  
        transform: translateY(-2px);  
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);  
    }  

    .f-day {  
        color: var(--text-secondary);  
        margin-bottom: 4px;  
        font-weight: 500;  
    }  

    .f-date {  
        font-size: 10px;  
        color: var(--text-tertiary);  
        margin-bottom: 8px;  
    }  

    .f-icon {  
        font-size: 24px;  
        color: var(--primary-blue);  
        margin: 8px 0;  
    }  

    .f-cond {  
        color: var(--text-secondary);  
        font-size: 11px;  
        margin-bottom: 8px;  
    }  

    .f-temp {  
        font-weight: 600;  
        color: var(--text-primary);  
    }  

    /* 昨天天气区域 - 去掉边框，用阴影 */  
    .yesterday-preview {  
        margin: 20px 15px;  
        background: var(--neutral-light);  
        border-radius: 12px;  
        overflow: hidden;  
        box-shadow: 0 2px 8px rgba(0,0,0,0.05);  
    }  

    [data-weui-theme='dark'] .yesterday-preview {  
        box-shadow: 0 2px 8px rgba(0,0,0,0.2);  
    }  

    .yesterday-preview .weui-form-preview__hd {  
        background: transparent;  
        padding-bottom: 10px;  
        border-bottom: 1px solid var(--border-color);  
    }  

    /* 主题切换按钮 */  
    .theme-fab {  
        position: fixed;  
        bottom: 30px;  
        right: 20px;  
        width: 44px;  
        height: 44px;  
        background: var(--primary-blue);  
        border-radius: 50%;  
        display: flex;  
        align-items: center;  
        justify-content: center;  
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);  
        z-index: 100;  
        color: white;  
        border: none;  
        cursor: pointer;  
        transition: all 0.3s ease;  
    }  

    .theme-fab:hover {  
        transform: scale(1.05);  
        box-shadow: 0 6px 16px rgba(0,0,0,0.2);  
    }  

    /* 搜索栏样式 - 修复圆角 */  
    .search-container {  
        padding: 10px 15px;  
        background: var(--neutral-light);  
        position: sticky;  
        top: 0;  
        z-index: 10;  
    }  

    .weui-search-bar {  
        background-color: transparent;  
        border: none;  
        border-radius: 8px;  
        overflow: hidden;  
    }  

    .weui-search-bar__box {  
        background-color: rgba(0,0,0,0.05);  
        border-radius: 8px;  
    }  

    [data-weui-theme='dark'] .weui-search-bar__box {  
        background-color: rgba(255,255,255,0.1);  
    }  

    .weui-search-bar__input {  
        color: var(--text-primary);  
    }  

    /* 搜索标签样式 */  
    .weui-search-bar__label {  
        border-radius: 8px;  
    }  

    /* 搜索框获取焦点时的样式 */  
    .weui-search-bar_focusing .weui-search-bar__input {  
        border-radius: 8px;  
    }  

    /* 搜索取消按钮样式 */  
    .weui-search-bar__cancel-btn {  
        color: var(--primary-blue);  
        border-radius: 4px;  
        padding: 0 8px;  
        transition: all 0.2s ease;  
    }  

    .weui-search-bar__cancel-btn:active {  
        background-color: rgba(44, 128, 255, 0.1);  
    }  

    /* 自动定位单元格 - 默认隐藏 */  
    .location-cell {  
        display: none;  
        margin-top: 10px;  
        background: transparent;  
    }  

    .location-cell.active {  
        display: block;  
    }  

    /* Information Bar 错误提示 - 修复关闭按钮为图标 */  
    .error-info-bar {  
        position: fixed;  
        top: 0;  
        left: 0;  
        right: 0;  
        z-index: 1000;  
        transform: translateY(-100%);  
        transition: transform 0.3s ease;  
        background: #fff;  
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);  
        padding: 8px 15px;  
    }  

    [data-weui-theme='dark'] .error-info-bar {  
        background: #2a2d32;  
        box-shadow: 0 2px 8px rgba(0,0,0,0.3);  
    }  

    .error-info-bar.active {  
        transform: translateY(0);  
    }  

    .weui-info-bar__bd {  
        color: var(--text-primary) !important;  
        display: flex;  
        align-items: center;  
        flex: 1;  
    }  

    .weui-info-bar__btn {  
        color: var(--text-tertiary);  
        font-size: 16px;  
        padding: 0;  
        width: 24px;  
        height: 24px;  
        display: flex;  
        align-items: center;  
        justify-content: center;  
        border-radius: 50%;  
        transition: all 0.2s ease;  
        margin-left: 10px;  
    }  

    .weui-info-bar__btn:hover {  
        background-color: rgba(0,0,0,0.05);  
        color: var(--text-secondary);  
    }  

    [data-weui-theme='dark'] .weui-info-bar__btn:hover {  
        background-color: rgba(255,255,255,0.1);  
    }  

    .weui-info-bar__btn i {  
        font-size: 14px;  
    }  

    .weui-info-bar {  
        display: flex;  
        align-items: center;  
        justify-content: space-between;  
    }  

    /* 加载指示器 */  
    .weui-toast {  
        z-index: 9999;  
    }  

    /* 隐藏初始内容 */  
    #mainContent {  
        display: none;  
    }  

    /* 分隔线样式 */  
    .section-divider {  
        height: 1px;  
        background-color: var(--border-color);  
        border: none;  
        margin: 20px 15px;  
    }  

    /* 单元格样式优化 */  
    .weui-cell {  
        padding: 12px 15px;  
        background: transparent;  
    }  

    .weui-cell_access .weui-cell__ft {  
        color: var(--text-tertiary);  
    }  

    /* 标题样式 */  
    .weui-cells__title {  
        color: var(--text-secondary);  
        font-size: 14px;  
        font-weight: 500;  
        padding: 15px 15px 5px;  
        margin-top: 0;  
    }  

    /* 页脚样式 */  
    .weui-footer {  
        margin-top: 30px;  
        margin-bottom: 20px;  
    }  

    .weui-footer__text {  
        color: var(--text-tertiary);  
    }  
    </style>  
</head>  

<body data-weui-theme="light">  
    <!-- Information Bar 错误提示 -->  
    <div class="weui-info-bar error-info-bar" id="errorInfoBar">  
        <div class="weui-info-bar__bd">  
            <i class="weui-icon-warn"></i>  
            <span id="errorText">出错了</span>  
        </div>  
        <a href="javascript:" class="weui-info-bar__btn" onclick="hideError()" title="关闭">  
            <i class="fas fa-times"></i>  
        </a>  
    </div>  

    <!-- 搜索区域 -->  
    <div class="search-container">  
        <div class="weui-search-bar" id="searchBar">  
            <form class="weui-search-bar__form" id="searchForm">  
                <div class="weui-search-bar__box">  
                    <i class="weui-icon-search"></i>  
                    <input type="search" class="weui-search-bar__input" id="searchInput" placeholder="搜索城市" required/>  
                    <a href="javascript:" class="weui-icon-clear" id="searchClear"></a>  
                </div>  
                <label class="weui-search-bar__label" id="searchText">  
                    <i class="weui-icon-search"></i>  
                    <span>搜索城市</span>  
                </label>  
            </form>  
            <a href="javascript:" class="weui-search-bar__cancel-btn" id="searchCancel">取消</a>  
        </div>  

        <!-- 自动定位单元格 - 默认隐藏 -->  
        <div class="weui-cells location-cell" id="locationCell">  
            <div class="weui-cell weui-cell_active weui-cell_access" onclick="getWeatherByIP()">  
                <div class="weui-cell__hd" style="margin-right: 10px;">  
                    <i class="fas fa-location-arrow" style="color: var(--primary-blue);"></i>  
                </div>  
                <div class="weui-cell__bd">  
                    <p>点击自动定位</p>  
                </div>  
                <div class="weui-cell__ft" id="gpsStatus"></div>  
            </div>  
        </div>  
    </div>  

    <!-- 主内容区域 -->  
    <div id="mainContent">  
        <div class="weather-hero">  
            <div class="update-badge">更新于 <span id="updateTime">--:--</span></div>  
            <div class="hero-city" id="uiCity">--</div>  
            <div class="hero-date" id="uiDate">--</div>  
              
            <div class="hero-main">  
                <div class="hero-icon" id="weatherIcon"><i class="fas fa-question"></i></div>  
                <div class="hero-temp" id="uiTemp">--°</div>  
            </div>  
              
            <div class="hero-status" id="uiWea">--</div>  
            <div class="hero-range"><span id="uiLowTemp">L:--</span> / <span id="uiHighTemp">H:--</span></div>  
            <div class="hero-notice" id="weatherNotice">--</div>  
        </div>  

        <!-- 详情网格 -->  
        <div class="weui-grids" id="currentDetails"></div>  

        <hr class="section-divider">  

        <!-- 未来7天预报 -->  
        <div class="weui-cells__title">未来7天预报</div>  
        <div class="forecast-scroll-container" id="forecastContainer"></div>  

        <hr class="section-divider">  

        <!-- 昨天天气 -->  
        <div class="weui-form-preview yesterday-preview">  
            <div class="weui-form-preview__hd">  
                <div class="weui-form-preview__item">  
                    <label class="weui-form-preview__label">昨天天气</label>  
                    <em class="weui-form-preview__value" id="yesterdayDate">--</em>  
                </div>  
            </div>  
            <div class="weui-form-preview__bd" id="yesterdayBody"></div>  
        </div>  
          
        <!-- 页脚 -->  
        <div class="weui-footer" style="margin-top: 30px; margin-bottom: 20px;">  
            <p class="weui-footer__text">树洞天气助手 &copy; 2026</p>  
            <p class="weui-footer__text">天气数据由第三方提供·定位信息来自你的网络IP</p>  
        </div>  
    </div>  

    <!-- 主题切换按钮 -->  
    <div class="theme-fab" onclick="toggleTheme()">  
        <i class="fas fa-moon" id="themeIcon"></i>  
    </div>  

    <!-- 加载中提示 -->  
    <div id="loadingToast" style="display: none;">  
        <div class="weui-mask_transparent"></div>  
        <div class="weui-toast">  
            <i class="weui-loading weui-icon_toast"></i>  
            <p class="weui-toast__content">加载中</p>  
        </div>  
    </div>  

    <script>  
        // --- 配置 ---  
        const API_KEY = "Nub0tYQ9brRDfSOfUXvA6xgoxb";  
        const WEATHER_URL = "https://api.hewoyi.com/api/weather/v1";  
        const IP_URL = "https://api.hewoyi.com/api/ipjwd/get";  

        // --- DOM 元素 ---  
        const uiCity = document.getElementById('uiCity');  
        const uiDate = document.getElementById('uiDate');  
        const uiTemp = document.getElementById('uiTemp');  
        const uiHighTemp = document.getElementById('uiHighTemp');  
        const uiLowTemp = document.getElementById('uiLowTemp');  
        const uiWea = document.getElementById('uiWea');  
        const weatherNotice = document.getElementById('weatherNotice');  
        const weatherIcon = document.getElementById('weatherIcon');  
        const updateTime = document.getElementById('updateTime');  
        const currentDetails = document.getElementById('currentDetails');  
        const forecastContainer = document.getElementById('forecastContainer');  
        const mainContent = document.getElementById('mainContent');  
        const errorInfoBar = document.getElementById('errorInfoBar');  
        const locationCell = document.getElementById('locationCell');  
          
        let lastCity = "北京";  

        // --- 初始化 ---  
        document.addEventListener('DOMContentLoaded', () => {  
            initSearch();  
            initTheme();  
            getWeatherByIP(); // 自动开始加载  
        });  

        // --- 搜索交互 ---  
        function initSearch() {  
            const $searchBar = document.getElementById('searchBar');  
            const $searchText = document.getElementById('searchText');  
            const $searchInput = document.getElementById('searchInput');  
            const $searchClear = document.getElementById('searchClear');  
            const $searchCancel = document.getElementById('searchCancel');  
            const $searchForm = document.getElementById('searchForm');  

            $searchText.addEventListener('click', function(){  
                $searchBar.classList.add('weui-search-bar_focusing');  
                $searchInput.focus();  
                locationCell.classList.add('active'); // 显示自动定位单元格  
            });  
              
            $searchCancel.addEventListener('click', function(){  
                $searchBar.classList.remove('weui-search-bar_focusing');  
                $searchInput.value = '';  
                locationCell.classList.remove('active'); // 隐藏自动定位单元格  
            });  

            $searchClear.addEventListener('click', function(){  
                $searchInput.value = '';  
                $searchInput.focus();  
            });  

            $searchForm.addEventListener('submit', function(e){  
                e.preventDefault();  
                const city = $searchInput.value.trim();  
                if(city){  
                    $searchInput.blur();  
                    $searchBar.classList.remove('weui-search-bar_focusing');  
                    locationCell.classList.remove('active'); // 搜索后隐藏  
                    getWeatherByCity(city);  
                }  
            });  
        }  

        // --- 主题切换 ---  
        function initTheme() {  
            const savedTheme = localStorage.getItem('theme') || 'light';  
            setTheme(savedTheme);  
        }  

        function toggleTheme() {  
            const body = document.body;  
            const current = body.getAttribute('data-weui-theme');  
            const next = current === 'dark' ? 'light' : 'dark';  
            setTheme(next);  
        }  

        function setTheme(theme) {  
            document.body.setAttribute('data-weui-theme', theme);  
            localStorage.setItem('theme', theme);  
            const icon = document.getElementById('themeIcon');  
            icon.className = theme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';  
        }  

        // --- 错误提示处理 ---  
        function showError(msg) {  
            const errorText = document.getElementById('errorText');  
            errorText.textContent = msg || '发生错误，请重试';  
            errorInfoBar.classList.add('active');  
              
            // 5秒后自动隐藏  
            setTimeout(() => {  
                hideError();  
            }, 5000);  
        }  

        function hideError() {  
            errorInfoBar.classList.remove('active');  
        }  

        // --- API 请求 ---  
        function showLoading() {  
            document.getElementById('loadingToast').style.display = 'block';  
        }  

        function hideLoading() {  
            document.getElementById('loadingToast').style.display = 'none';  
        }  

        async function getWeatherByIP() {  
            showLoading();  
            document.getElementById('gpsStatus').innerText = "定位中...";  
            try {  
                const res = await fetch(`${IP_URL}?key=${API_KEY}&ip=`);  
                const data = await res.json();  
                  
                if (data.code === 200 && data.data && data.data.info) {  
                    const city = data.data.info.city.replace(/市$/, '');  
                    document.getElementById('gpsStatus').innerText = "已定位: " + city;  
                    getWeatherByCity(city);  
                } else {  
                    document.getElementById('gpsStatus').innerText = "定位失败";  
                    getWeatherByCity("北京"); // 默认  
                }  
            } catch (error) {  
                console.error(error);  
                document.getElementById('gpsStatus').innerText = "网络错误";  
                getWeatherByCity("北京");  
            }  
        }  

        async function getWeatherByCity(city) {  
            showLoading();  
            try {  
                const response = await fetch(`${WEATHER_URL}?key=${API_KEY}&city=${encodeURIComponent(city)}`);  
                const data = await response.json();  
                  
                hideLoading();  
                if (data.code === 200 && data.data) {  
                    lastCity = city;  
                    renderWeather(data, city);  
                } else {  
                    showError(data.msg || "查询失败，请检查城市名称");  
                }  
            } catch (error) {  
                hideLoading();  
                showError("网络连接失败，请检查网络设置");  
                console.error(error);  
            }  
        }  

        // --- 渲染逻辑 ---  
        function renderWeather(weatherData, city) {  
            mainContent.style.display = 'block';  
            const data = weatherData.data;  
            const meta = weatherData.msg;  

            // 1. 头部信息  
            uiCity.textContent = meta.city || city;  
            uiTemp.textContent = data.wendu + "°";  
            updateTime.textContent = meta.updateTime || "刚刚";  
              
            const now = new Date();  
            uiDate.textContent = `${now.getMonth()+1}月${now.getDate()}日 ${['周日','周一','周二','周三','周四','周五','周六'][now.getDay()]}`;  

            if (data.forecast && data.forecast.length > 0) {  
                const today = data.forecast[0];  
                uiHighTemp.textContent = today.high;  
                uiLowTemp.textContent = today.low;  
                uiWea.textContent = today.type;  
                weatherNotice.textContent = today.notice;  
                setWeatherIcon(today.type, weatherIcon);  
            }  

            // 2. 详情网格  
            renderGrid(data);  

            // 3. 预报  
            renderForecast(data.forecast);  

            // 4. 昨天  
            renderYesterday(data.yesterday);  
        }  

        function renderGrid(data) {  
            currentDetails.innerHTML = '';  
              
            const items = [  
                { label: '湿度', value: data.shidu || '--', icon: 'fa-tint' },  
                { label: 'PM2.5', value: data.pm25 || '--', icon: 'fa-smog' },  
                { label: '空气质量', value: data.quality || '--', icon: 'fa-leaf' },  
            ];  

            if (data.forecast && data.forecast[0]) {  
                const today = data.forecast[0];  
                items.push(  
                    { label: '风向', value: today.fx || '--', icon: 'fa-location-arrow' },  
                    { label: '风力', value: today.fl || '--', icon: 'fa-flag' }  
                );  
            }  
            items.push({ label: 'PM10', value: data.pm10 || '--', icon: 'fa-industry' });  

            items.forEach(item => {  
                const html = `  
                    <a href="javascript:" class="weui-grid">  
                        <div class="weui-grid__icon">  
                            <i class="fas ${item.icon}"></i>  
                        </div>  
                        <p class="weui-grid__label">  
                            ${item.label}  
                            <span class="grid-value">${item.value}</span>  
                        </p>  
                    </a>  
                `;  
                currentDetails.innerHTML += html;  
            });  
        }  

        function renderForecast(forecast) {  
            if (!forecast) return;  
            forecastContainer.innerHTML = '';  
              
            forecast.forEach(day => {  
                const html = `  
                    <div class="forecast-item">  
                        <div class="f-day">${day.week.replace('星期','周')}</div>  
                        <div class="f-date">${day.date}</div>  
                        <div class="f-icon">${getIconClass(day.type)}</div>  
                        <div class="f-cond">${day.type}</div>  
                        <div class="f-temp" style="margin-top:5px;">${day.high.replace('高温 ','')}</div>  
                        <div class="f-temp" style="font-weight:400; opacity:0.7">${day.low.replace('低温 ','')}</div>  
                    </div>  
                `;  
                forecastContainer.innerHTML += html;  
            });  
        }  

        function renderYesterday(y) {  
            if(!y) return;  
            document.getElementById('yesterdayDate').innerText = `${y.ymd} ${y.week}`;  
              
            const body = document.getElementById('yesterdayBody');  
            body.innerHTML = `  
                <div class="weui-form-preview__item">  
                    <label class="weui-form-preview__label">天气状况</label>  
                    <span class="weui-form-preview__value">${y.type || '--'}</span>  
                </div>  
                <div class="weui-form-preview__item">  
                    <label class="weui-form-preview__label">温度范围</label>  
                    <span class="weui-form-preview__value">${y.low || '--'} ~ ${y.high || '--'}</span>  
                </div>  
                <div class="weui-form-preview__item">  
                    <label class="weui-form-preview__label">风力风向</label>  
                    <span class="weui-form-preview__value">${y.fx || '--'} ${y.fl || '--'}</span>  
                </div>  
                <div class="weui-form-preview__item">  
                    <label class="weui-form-preview__label">日记</label>  
                    <span class="weui-form-preview__value" style="font-size:12px;">${y.notice || '--'}</span>  
                </div>  
            `;  
        }  

        // --- 工具函数 ---  
        function getIconClass(type) {  
            if (!type) return '<i class="fas fa-cloud"></i>';  
            
            let icon = 'fas fa-cloud';  
            if (type.includes('晴')) icon = 'fas fa-sun';  
            else if (type.includes('多云')) icon = 'fas fa-cloud-sun';  
            else if (type.includes('阴')) icon = 'fas fa-cloud';  
            else if (type.includes('雨')) icon = 'fas fa-cloud-rain';  
            else if (type.includes('雪')) icon = 'fas fa-snowflake';  
            else if (type.includes('雷')) icon = 'fas fa-bolt';  
            else if (type.includes('雾') || type.includes('霾')) icon = 'fas fa-smog';  
              
            return `<i class="${icon}"></i>`;  
        }  

        function setWeatherIcon(type, el) {  
            el.innerHTML = getIconClass(type);  
        }  
    </script>  
</body>  
</html>  
